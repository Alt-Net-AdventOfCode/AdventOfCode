using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;

namespace AdventCalendar2018
{
    public static class Day13
    {
        private static void MainDay13()
        {
            var map = Input.Split(Environment.NewLine).ToList();
            var carts = new List<Cart>();
            for (var y = 0; y < map.Count; y++)
            {
                var curLine = map[y];
                for (var x = 0; x < curLine.Length; x++)
                {
                    switch (curLine[x])
                    {
                        case '>':
                            carts.Add(new Cart(x, y, 0));
                            break;
                        case 'v':
                            carts.Add(new Cart(x, y, 1));
                            break;
                        case '<':
                            carts.Add(new Cart(x, y, 2));
                            break;
                        case '^':
                            carts.Add(new Cart(x, y, 3));
                            break;
                    }
                }
            }

            while (true) 
            {
                carts.Sort();
                for (var i = 0; i < carts.Count; i++)
                {
                    var cart = carts[i];
                    if (!cart.Move(map)) continue;
                    // we look for the other cart
                    carts.RemoveAt(i--);

                    for (var j = 0; j < carts.Count; j++)
                    {
                        if (carts[j].X == cart.X && carts[j].Y == cart.Y)
                        {
                            Console.WriteLine($"Crash at: {cart.X},{cart.Y} between #{cart.Id} and #{carts[j].Id}");
                            carts[j].RemoveCart(map);
                            carts.RemoveAt(j);
                            if (j <= i)
                            {
                                i--;
                            }
                            break;
                        }
                    }
                }
                if (carts.Count == 1)
                {
                    Console.WriteLine($"Last cart at {carts[0].X}, {carts[0].Y}");
                    break;
                }
            }
        }

        private static void Dump(IList<string> map, int x, int y, int width, int height)
        {
            Console.WriteLine();
            for (var i = y; i< Math.Min(y+height, map.Count); i++)
            {
                Console.WriteLine($"{i:000}:{map[i].Substring(x, Math.Min(map[i].Length-x, width))}");
            }
        }

        private class Cart: IComparable<Cart>
        {
            private readonly int id;

            public int Id => id;

            private static int autoId;
            private int x;
            private int y;
            private int currentDir;
            private int lastChange;

            private char curCell;

            public Cart(int x, int y, int currentDir)
            {
                this.x = x;
                this.y = y;
                this.currentDir = currentDir;
                curCell = this.currentDir % 2 == 0 ? '-' : '|';
                id = autoId++;
            }

            public int Y => y;

            public int X => x;

            public int CompareTo(Cart other)
            {
                if (ReferenceEquals(this, other)) return 0;
                if (ReferenceEquals(null, other)) return 1;
                var yComparison = y.CompareTo(other.y);
                return yComparison != 0 ? yComparison : x.CompareTo(other.x);
            }

            public void Dump(IList<string> map)
            {
                const int width = 20;
                const int height = 10;
                Day13.Dump(map, Math.Max(0, X-width/2), Math.Max(0, Y - height/2), width, height);
            }
            
            public bool Move(IList<string> map)
            {
                // restore cell
                RemoveCart(map);
                switch (currentDir)
                {
                    case 0:
                        x++;
                        break;
                    case 1:
                        y++;
                        break;
                    case 2:
                        x--;
                        break;
                    case 3:
                        y--;
                        break;
                }

                curCell = map[y][x];

                switch (curCell)
                {
                    case '^':
                    case '>':
                    case 'v':
                    case '<':
                        return true;
                    case '\\':
                        if (currentDir == 0)
                        {
                            currentDir = 1;
                        }
                        else if (currentDir == 1)
                        {
                            currentDir = 0;
                        }
                        else if (currentDir == 2)
                        {
                            currentDir = 3;
                        }
                        else
                        {
                            currentDir = 2;
                        }
                        break;
                    case '/':
                        if (currentDir == 1)
                        {
                            currentDir = 2;
                        }
                        else if (currentDir == 0)
                        {
                            currentDir = 3;
                        }
                        else if (currentDir == 2)
                        {
                            currentDir = 1;
                        }
                        else
                        {
                            currentDir = 0;
                        }
                        break;
                    case '+':
                        if (lastChange == 2)
                        {
                            currentDir = currentDir + 1;
                        }
                        else if (lastChange == 1)
                        {
                            // no change
                        }
                        else if (lastChange == 0)
                        {
                            currentDir = currentDir + 3;
                        }

                        currentDir %= 4;
                        lastChange = (lastChange+1) % 3;
                        break;
                }

                var next = '^';
                if (currentDir == 0)
                    next = '>';
                else if (currentDir == 1)
                    next = 'v';
                else if (currentDir == 2)
                    next = '<';
                else if (currentDir == 3)
                    next = '^';

                map[y] = map[y].Substring(0, x) + next + map[y].Substring(x + 1);
                return false;
            }

            public void RemoveCart(IList<string> map)
            {
                map[y] = map[y].Substring(0, x) + curCell + map[y].Substring(x + 1);
            }
        }

        private const string Input =
@"                                         /----------------------------------------------------------------------------------------------------------\ 
                                         |                                                 /---------------------\           /-----------------\    | 
          /-------------------------\    |                                        /--------+-----------\         |           | /----------\    |    | 
          |              /----------+----+----------------------------------------+--------+-----------+-------\ |           | |          |    |    | 
          | /------------+\         |    |              /-------------------------+--------+-\         |       | |           | |          |    |    | 
          | |            ||         |    |         /----+-------------------------+--------+-+---------+-------+-+-\         | |          |    |    | 
          | |         /--++--------\|   /+---------+----+-------------------------+--------+\|         |    /--+-+-+---------+-+----------+-\  |    | 
          | |         |  ||      /-++---++---------+----+-------------------------+--------+++---------+----+--+-+-+---------+-+----\     | |  |    | 
          | |         |  ||/-----+-++---++---------+----+--\   /------------------+--------+++---------+----+--+-+-+---------+-+----+-----+-+--+\   | 
/---------+-+---------+--+++-----+-++---++---------+----+--+---+-\                |        |||         |    |  | | |         | |    |     | |  ||   | 
|         | |         |  |||     | ||   ||         |    |  |   | |  /---------\   |        |||         |    |  | | |         | |    |     | |  ||   | 
|         | |         |  |||    /+-++---++---------+----+--+---+-+--+---------+---+--------+++---------+----+--+-+\|         | |    |     | |  ||   | 
|         | |         |  |||    || ||   ||         |   /+--+---+-+--+---------+---+--------+++------\  |    |  | |||         | \----+-----/ |  ||   | 
|      /--+-+---------+--+++----++-++---++---------+---++--+---+-+--+-------\ |   |        |||      |  |    |  | |||         |      |       |  ||   | 
|  /---+--+-+---------+--+++----++-++---++->\      |   ||  |   | |  |       | |   |        |||      |  |    |  | |||         |      |       |  ||   | 
|  |   |  | |         |  |||    || ||   ||  |  /---+---++--+---+-+--+-------+-+---+--------+++------+--+----+--+-+++---------+----\ |       |  ||   | 
|  |   |  | |         |  |||    || ||   ||  |  v   |/--++--+-\ | |  |       | |   |        |||  /---+--+----+--+-+++--------\|    | |       |  ||   | 
|  |   |  | |         |/-+++----++-++---++--+--+---++--++--+-+-+-+--+-------+\|   |        |||  |   |  | /--+--+-+++--------++----+-+-------+--++--\| 
|  |   |  | |     /---++-+++----++-++---++--+--+---++--++--+-+-+-+--+--\    |||   |        |||  |   |  | |  |  | |||        ||    | |       |  ||  || 
|  |   |  | |     |   || |||    || ||   ||  |  |   ||  ||  | | | |  |  |    |||   |        |||  | /-+--+-+--+--+-+++--------++----+-+---\   |  ||  || 
|  |   |  | |     |   || |||    || ||   ||  |  |   ||  ||/-+-+-+-+--+--+----+++---+--------+++--+-+-+--+-+--+--+-+++--------++-\  | |   |   |  ||  || 
|  |   |  | |  /--+---++-+++----++-++---++--+--+---++--+++-+-+-+-+\ |  | /--+++---+--------+++--+-+-+>-+-+--+--+-+++--------++-+--+-+---+---+--++\ || 
|  |   |  | |  | /+---++-+++----++\||   \+--+--+---++--+++-+-+-+-++-+--+-+--+++---+--------+/|  | | |  | |  |/-+-+++--------++-+--+-+---+-\ |  ||| || 
|  |   |  | |  | ||   || |||    |||||    |  |  |   ||  ||| | | | || |  | |  |||   | /------+-+--+-+-+--+-+--++-+-+++--------++-+\ | |   | | |  ||| || 
|  |   |  | |  | ||   \+-+++----+++/|    \--+--+---++--+++-+-+-+-++-+--+-+--+++---+-+------+-+--+-+-+--+-+--++-+-+++--------++-++-+-+-<-+-+-+--+++-+/ 
|  \---+--+-+--+-++----+-+++----+++-+-------/  |  /++--+++-+-+-+-++-+--+\|  |||   | |      \-+--+-+-+--+-+--++-+-/||        || || | |   | | |  ||| |  
|      |  | |  | ||    | |||    ||| |          |  |||  ||| | | | || |  |||  |||   | |        | /+-+-+--+-+--++-+--++--------++-++-+-+--\| | |  ||| |  
|      |  | |  | ||    | |||    ||| |          |  |||  ||| | | | || |  |||  |||   | |        | || | |  | |  || |  ||        || || | |  || | |  ||| |  
|      |  | |  | ||    | |||    ||| |          |  |||  ||| | | | || |  |||  |||   | |  /-----+-++-+-+--+-+--++-+--++------\ || || | |  || | |  ||| |  
|      |  | |  |/++----+-+++----+++-+----------+--+++--+++-+-+-+-++-+--+++--+++---+-+--+-----+-++-+-+--+-+--++-+-\||      | || || | |  || | |  ||| |  
|      |/-+-+--++++----+-+++----+++-+----------+--+++--+++-+-+-+\|| |  |||  |||   | |  |     | ||/+-+--+-+--++-+-+++-----\| || ||/+-+--++-+-+--+++\|  
|/-----++-+-+--++++----+-+++----+++-+----------+--+++\ ||| | | |||| |  |||  |||   | |  | /---+-++++-+--+-+--++-+-+++-----++-++-++++-+--++-+-+--+++++\ 
||     || | |  ||||/---+-+++----+++-+----------+\ |||| ||| | | |||| |  |||  |||   \-+--+-+---+-++++-+--/ |  || | |||     || || |||| |  || | |  |||||| 
||     || | |  |||||   | |||    |||/+----------++-++++-+++-+-+-++++-+--+++--+++-----+--+-+---+-++++-+----+--++-+-+++-----++-++-++++-+--++-+\|  |||||| 
||     || | |  |||||   | |||    |||||          || ^||| ||| | | |||| |  |||  |||     |  | |   | |||| |    |  || | |||     || || |||| |  || |||  |||||| 
||     || | |  |||||   | |||   /+++++----------++-++++-+++-+-+-++++-+--+++--+++-----+--+-+---+-++++-+----+--++-+-+++-----++-++-++++\|  || |||  |||||| 
||     || | |/-+++++---+-+++-\ ||||||          || |||| ||| | | |||| |  |||  |||     |  | |   | |||| |    |  || | |||     || || ||||||  || |||  |||||| 
||     || | || |||||   | ||| | ||||||          ||/++++-+++-+-+-++++-+-\|||  |||     |  | |  /+-++++-+----+--++-+-+++-----++\|| ||||||  || |||  |||||| 
||     || | || |||||   | ||| | ||||||    /-----+++++++-+++-+-+-++++-+-++++--+++-----+--+-+--++-++++-+----+--++-+-+++-----+++++-++++++--++-+++\ |||||| 
||     || | || |||||   | ||| | ||||||    |     ||||||| ||| | | |||| | ||||  |||     |  | |  || |||| |    |  || | |||     ||||| ||||||  || |||| |||||v 
||     || | || |||||   | ||| | ||||||   /+-----+++++++-+++-+-+-++++-+-++++--+++-----+--+-+--++-++++-+----+--++\| |||     ||||| ||||||  || |||| |||||| 
||     || | || |||||   | ||| | ||||||   ||     ||||||| ||| | | |||| | ||||  |||     |  | \--++-++++-+----+--++++-+++-----+++++-++++++--++-++++-+++++/ 
||     || | || |||||   | ||| | ||||||   ||     ||||||| |||/+-+-++++-+-++++--+++----\|  |    || |||| |    |  |||| |||     ||||| ||||||  || |||| |||||  
||     || | || |||||   | ||| | ||||||   ||     ||||||| \++++-+-++++-+-++++--+++----++--+----++-++++-/    |  |||| |||     ||||| ||||||  || |||| |||||  
||     || \-++-+++++---+-+++-+-+++++/   ||    /+++++++--++++-+-++++-+-++++--+++----++--+----++-++++------+--++++-+++-----+++++-++++++--++\|||| |||||  
||     ||   || |||||   | |||/+-+++++----++----++++++++--++++-+-++++-+-++++--+++--\ ||  |/---++-++++------+--++++-+++-----+++++-++++++-\||||||| |||||  
||     ||   || |||||   | ||\++-+++++----++----++++++++--+++/ | |||| |/++++--+++--+-++\ || /-++-++++------+--++++-+++----\||||| |||||| |||||||| |||||  
||     ||   || |||||   | || || |||||    ||    ||||||||  |||  | |||| ||||||  |||  | ||| || | || ||||      |  |||| |||    |||||\-++++++-++++++++-/||||  
||  /--++---++-+++++---+-++-++-+++++--\ ||    ||||||||  ||| /+-++++-++++++--+++--+-+++-++-+-++-++++------+--++++-+++----+++++\ |||||| ||||||||  ||||  
||  |  ||   ||/+++++---+-++-++-+++++--+-++----++++++++--+++-++-++++-++++++--+++--+-+++-++-+-++\||||      |  |||| |||    |||||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   | || || |||||  | ||    ||||||||  ||| || |||| ||||||  |||  | ||| || | |||||\+------+--++++-+++----+/|||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   |/++-++-+++++--+-++----++++++++--+++-++-++++-++++++--+++--+\||| || | ||||| |      |  |||| |||    | |||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   |||| || |||||  | ||   /++++++++--+++-++-++++-++++++--+++--+++++-++-+-+++++-+--\   |  |||| |||    | |||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   ||^| || |||||  | || /-+++++++++--+++-++-++++-++++++--+++--+++++-++-+-+++++-+--+---+--++++-+++---\| |||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   |||| || |||||  | || | |||||||||  ||| || |||| ||||||  |||  ||||| || | ||||| |  |   |  |||| |||   || |||| |||||| ||||||||  ||||  
||  | /++---++++++++---++++-++-+++++--+-++-+-+++++++++--+++-++-++++-++++++--+++-\||||| || | ||||| |  |   |  |||| |||   || |||| |||||| ||||||||  ||||  
||  | |||   |\++++++---++++-+/ |||||  | || | |||||||||  ||| || |||| ||||||  ||| |||||| ||/+-+++++-+--+---+--++++-+++---++\|||| |||||| ||||||||  ||||  
|| /+-+++---+-++++++---++++-+--+++++--+-++-+-+++++++++--+++-++-++++-++++++--+++-++++++-++++-+++++-+--+---+\ |||| |||   ||||||| |||||| ||||||||  ||||  
|| || |||/--+-++++++---++++-+--+++++--+-++-+-+++++++++--+++-++-++++-++++++--+++-++++++-++++\||||| |  |   || |||| |||   ||||||| |||||| ||||||||  ||||  
|| || ||||  | ||||||   |||| |  |||||  | || | |||||||||  ||| || |||| ||||||  ||| |||||| |||||||||| |  |   \+-++++-+++---+++++++-++++++-++++++++--+++/  
|| || ||||  | ||||||   |||| |  |||||  | || | |||||||||  ||| || |||| ||||||  ||| |||||| |||||||||| |  |    | |||| |||   ||||||| |||||| ||||||||  |||   
|| || ||||  | ||||||   |||| |  |||||  | || | |||||||||  \++-++-++++-++++++--+++-++++++-++++++/||| |  |    | |||| |||   |||||||/++++++-++++++++--+++-\ 
|| || ||||  | ||||||   |||| |  |||||  | |\-+-+++++++++---++-++-++++-++++++--+++-++++++-++++++-+++-+--+----+-++++-+++->-++++++++++++++-+++++++/  ||| | 
|| || ||||  | |||||\---++++-+--+++++--+-+--+-+++/|||||   || ||/++++-++++++-\||| |||||| |||||| ||| |  |    | |||| |||   |||||||||||||| |||||||   ||| | 
|| || ||||  | |||||/---++++-+--+++++--+-+-\| ||\-+++++---++-+++++++-++++++-++++-++++++-++++++-+++-+--+----+-++++-+++---+++++++++++/|| |||||||   ||| | 
|| || |\++--+-++++++---++++-+--+++++--+-+-++-++--+++++---++-+++++++<++++++-+/|| |||||| \+++++-+++-+--+----+-++++-+++---+++/||||||\-++-+++++++---++/ | 
|| || | ||  | ||||||   |||| |  |||||  | | || ||  |||||   || ||||||| |\++++-+-++-+++++/  ||||| ||| |  |    | |||| |||   ||| ||||||  || |||||||   ||  | 
|| || | ||  | ||||||  /++++-+--+++++--+-+-++-++\ |||||   || ||||||| |/++++-+-++-+++++---+++++-+++-+--+----+-++++-+++---+++-++++++\ || |||||||   ||  | 
|| ||/+-++--+-++++++--+++++-+--+++++--+-+-++-+++-+++++---++-+++++++-++++++\| || |||||   ||||| ||| |  |    | |||| |||   ||| ||||||| || |||||||   ||  | 
|| |||| ||  | ||||||  ||||| |  |||||  | | || ||| |||||   || ||||||| |||||\++-++-+++++---+++++-+++-+--+----+-++++-+++---+++-+++++++-++-+++++++---+/  | 
|| |||| ||  | ||||||  ||||| |  |||||  |/+-++-+++-+++++---++\||||||| ||||| || || |||||   ||||| ||| |  |    | |||| |||   ||| ||||||| || |||||||   |   | 
|| |||| ||  | |||||| /+++++-+--+++++--+++-++-+++-+++++---++++++++++-+++++-++-++-+++++---+++++-+++-+--+\   | |||| |||   ||| ||||||| || |||||||   |   | 
|| |||| ||  ^ |||||| |||||| |  |||||  ||| || ||| ||||| /-++++++++++-+++++-++-++-+++++---+++++-+++-+--++\/-+-++++-+++---+++-+++++++-++-+++++++--\|   | 
|| |||| ||  | \+++++-++++++-+--+++++--+++-++-+++-+++++-+-++++++++++-+++++-++-++-+++++---+++++-/||/+--++++-+-++++-+++-\ ||| ||||||| || |||||||  ||   | 
|| |||| ||  |  \++++-++++++-+--+++++--+++-++-+++-+++++-+-+++++++++/ ||||| || || |||||   |||||  ||||  |||| | |||| ||| | ||| ||||||| || |||||||  ||   | 
|| |||| ||  |   |||| |||||| |  |||||  ||| |\-+++-+++++-+-+++++++++--+++++-++-++-+++++---+++++--++++--++++-+-++++-+++-+-/|| ||||||| || |||||||  ||   | 
|| |||| ||  |   |||| |||||| |  |||||  |||/+--+++-+++++-+-+++++++++--+++++-++-++-+++++---+++++--++++--++++-+-++++-+++-+--++-+++++++-++-+++++++\ ||   | 
|| |||| ||  |   |||| |||||| |  |||||  |||||  ||| ||||| | |||||||||  ||||| || || |||||   |||||  ||||  |||| | |||| ||| |  || ||||||| || |||||||| ||   | 
|| |||| || /+---++++-++++++-+--+++++--+++++\ ||| ||||| | |||||||||  ||||| || || |||||   |||||  ||||  |||| | |||| ||| |  || ||||||| || |||||||| ||   | 
|| |||| || ||   |||| |||||| |  |\+++--++++++-+++-+++++-+-+++++++++--+++++-++-++-+++++---+++++--++++--++++-+-++++-+/| |  || ||||||| || |||||||| ||   | 
|| |||| \+-++---++++-++++++-+--+-+++--++++++-+++-+++++-+-+++++++/|  ||||| || || |||||   |||||  ||||  |||| | |||| | | |  || ||||||| || |||||||| ||   | 
|| ||||  | ||   |||| |||||| |  \-+++--++++++-+++-+++++-+-+++++++-+--+++++-++-++-+++++---+++++--++++--++++-+-++++-+-+-+--++-+++++++-/| |||||||| ||   | 
|| ||||  | ||   |||| |||||| |    |||  |||||| ||| ||||| | ||||||| |  ||||| || || ||||\---+++++--++++--++++-+-++++-+-+-+--++-+++++/|  | |||||||| ||   | 
|| |||| /+-++---++++-++++++-+----+++--++++++\||| ||||| | ||||||| |  ||||| || || ||||    |||||  ||||  |||| | \+++-+-+-+--++-+++++-+--+-++++++/| ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    |||||  ||||  |||| |  ||| | | |  || ||||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    |||||  ||||  |||| |  ||| | | |  || ||||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    ||||\--++++--++++-+--+++-+-+-+--++-/|||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    ||||   ||||  |||| |  ||| | | |  ||  |||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    ||||   |\++--++++-+--+++-+-+-+--++--/||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| |\+++-+-+++++++-+--++++/ || || ||||  /-++++---+-++--++++-+--+++-+-+-+--++---+++-+--+-++++++-+-++--\| 
|| |||| || ||   |||| |||||| |    |||  |||||||||| | ||| | ||||||| |  ||||  || || ||||  | ||||   | ||  |||| |  ||| | | |  ||   ||| |  | |||||| | ||  || 
|| |||| || ||   |||| |||||| |    |||  |||||||||| | ||| | ||||||| | /++++--++-++-++++--+-++++---+-++--++++-+--+++-+-+-+--++---+++-+--+-++++++-+\||  || 
|| ||||/++-++---++++-++++++-+---\\++--++++++++++-+-+++-+-+++++++-+-+++++--++-++-++++--+-++++---+-++--++++-+--+++-+-+-+--++---+++-+--/ |||||| ||||  || 
|| ||||||| ||   |||| |||||| |   | ||  |||||||||| | ||| | ||||||\-+-+++++--++-++-++++--+-++++---+-++--++++-+--+++-+-+-+--++---+++-+----++++++-+++/  || 
|| ||||||| ||   |||| \+++++-+---+-++--++++++++++-+-+++-+-++++++--+-+++++--++-++-++++--+-++++---+-++--+/|| |  ||| | | |  ||   ||| |    |||||| |||   || 
|| ||||||| ||   ||||  ||||| |   | ||  |||||||||| | ||| | ||||||  | |||||  || || ||||  | ||||   | |^  | || |  ||| | | |  ||   |\+-+----++++++-+++---+/ 
|| |||\+++-++---++++--+++++-+---+-++--++++++++++-+-+++-+-++++++--+-+++++--++-++-/|||  | ||||   | ||  | || |  ||| | | |  ||   | | |    |||||| |||   |  
|| ||| ||| ||   ||||  ||||| |   | ||  |\++++++++-+-+++-+-++/|||  | |||||  || ||  |||  | ||||   | ||  | || |  ||| | | |  ||   | v |    |||||| |||   |  
|| ||| ||| ||   ||||  |||\+-+---+-++--+-++++++++-+-+++-+-++-+++--+-+++++--++-++--+++--+-++++---+-++--+-++-+--++/ | | |  ||   | | |    |||||| |||   |  
|| ||| ||| ||   ||||  ||| | |   | ||  | |||||||| | ||| | || |||  | |\+++--++-+/  |||  | ||||   | ||  |/++-+--++--+-+-+--++---+-+-+-\  |||||| |||   |  
|| ||| ||| ||   ||||  ||| | |   | ||  | |||||||| | ||| | || ||\--+-+-+++--+/ |   |||  | ||||   | ||  |||| |  ||  | | |/-++---+-+-+-+--++++++-+++-\ |  
|| ||| |||/++---++++--+++-+\|   | ||  | |||||||| | ||| | \+-++---+-+-+++--+--+---+++--+-++++---+-++--++++-+--++--+-+-++-++---+-//+-+--++++++-+++-+\|  
|| ||| ||||||   ||||  ||| |||   | ||  | |||||||| | ||| |  | ||   | | |||  |  |   |||  | ||||   | ||  |||| |  ||  | | || ||   |  || |  |||||| ||| |||  
\+-+++-++++++---++++--+++-+++---+-++--+-++++++++-+-+++-+--+-++---/ | |||  |  |   |||  | ||||   | ||  |||| |  ||/-+-+-++-++---+\ || |  |||||| ||| |||  
 | |\+-++++++---++++--+++-+++---+-++--/ ||||||\+-+-+++-+--+-++-----+-+++--+--+---+++--+-++++---+-++--++++-+--+++-+-+-++-++---++-++-+--+++/|| ||| |||  
 | | | |||||\---++++--+++-/||   | ||    |||||| | | ||| |  | ||     | |||  |  |   |||  | |||| /-+-++--++++-+--+++-+-+-++-++---++-++-+--+++-++\||| |||  
 | | | |||||   /++++--+++--++---+-++----++++++-+-+\\++-+--+-++-----+-+++--+--+---+++--+-++++-+-+-++--++++-+--+++-+-/ || ||   || || |  ||| |||||| |||  
 | | | |||||   |||\+--+++--++---+-++----++++++-+-++-++-+--+-++-----+-++/  |  |   |||/-+-++++-+-+-++--++++\|  ||| |   || ||   || || |  ||| |||||| |||  
 | | | |||||   ^|| |  ||\--++---+-++----++++++-+-++-++-+--+-++-----+-++---+--+---+/|| | |||| | \-++--++++++--+++-+---++-++---++-++-+--+/| |||||| |||  
 | | | ||||\---+++-+--++---++---+-++----+++/|| | || || |  |/++-----+-++---+--+---+-++-+\|||| |   ||  ||||||  ||| |   || ||   || || |  | | |||||| |||  
 | | | ||||    ||| |  ||   ||   | ||    \++-++-+-++-++-+--++++-----+-++---+--+---+-++-++++++-+---++--++++++--+/| |   || ||   || \+-+--+-+-++++++-+/|  
 | | | ||||    ||| |  ||   ||   | ||     || || | || || |  \+++-----+-++---+--+---+-/| |||||| |   ||  ||||||  | | |   || ||   ||  | |  | | |||||| | |  
 | | | ||||    ||| |  |\---++---+-++-----++-++-+-++-++-+---+++-----+-++---+--/   |  | |||||| |   ||  ||||||  | | |   || ||   ||  | |  | | |||||| | |  
 | | | |\++----+++-+--+----++---+-++-----++-/| | || \+>+---++/     \-++---+------+--+-++++++-+---++--++++++--+-+-+---++-++---++--+-+--+-+-++++/| | |  
 | | | | ||    ||\-+--+----++---+-/|     ||  | | ||  | |   ||        ||   |      |  | |||||| |   ||  ||||||  | | |   || ||   ||  | |  | | |||| | | |  
 | | | | ||  /-++--+--+----++---+--+-----++--+-+-++--+\|   ||        ||   |      |  | |||||| |   ||  ||||||  | | |   || ||  /++--+-+--+-+-++++-+-+\|  
 | | | | ||  | ||  |/-+----++---+--+-----++--+-+-++--+++---++--------++---+------+--+-++++++-+--\||  ||||||  | | |   || ||  |||  | |  | | |||| | |||  
 | | | | ||  | ||  || |    ||   |  |     ||  | ^ ||  |||   ||        ||   |      |  | |||||| |  |||  ||||||  | | |   || ||  |||  | |  | | |||| | |||  
 | | | | ||  | ||  || |    ||   |  |     ||  | | ||  |||   ||        ||   |      |  | |||||| |  ||\--++++++--+-+-+---++-++--+++--+-+--+-/ |||| | |||  
 | | | | ||  | \+--++-+----++---+--+-----++--+-+-+/  |||   || /------++---+------+--+-++++++-+--++<--++++++--+-+-+---++-++--+++--+-+--+---++++-+-+++-\
 | | | | ||  |  |  || |    ||   |  |     ||  | | |   |||   || |      ||   |      |  | |||\++-+--++---++++++--+-+-+---++-+/  |||  | |  |   |||| | ||| |
 \-+-+-+-++--+--+--++-+----++---+--+-----++--+-+-+---/||   || |      ||   |      |  | ||| || |  ||   ||||||  | | |   |\-+---+++--+-+--+---++++-+-/|| |
   | | | ||  |  |  || |    ||   |  |     ||  | | \----++---++-+------+/   |      |  | ||| || |  ||   |\++++--+-+-+---+--+---+++--+-/  |   |||| |  || |
   | | | ||  |  |  || |    ||   |  |     ||  | |      ||   || |      |    |      |  | ||| || |  ||   | ||||  \-+-+---+--+---+++--+----+---/||| |  || |
   | \-+-++--+--+--++-+----++---+--+-----++--+-+------++---++-+------+----/      |  | ||| || |  |\---+-++++----+-+---/  |   |||  |    |    ||| |  || |
   |   | ||  |  |  || |    ||   |  |     ||  | |      ||   || |      |           |  | ||| || |  |   /+-++++----+-+------+---+++--+----+---\||| |  || |
   |   | ||  |  |  || |    ||   |  |     ||  | |      ||   || |      |           |  | ||| || |  |   || |\++----+-+------+---+++--+----+---++++-/  || |
   |   | ||  |  |  || |    ||   |  \-----++--+-+------++---++-+------+-----------+--+-+++-++-+--+---++-+-++----+-+------+---+++--+----+---+/||    || |
   |   | ||  |  |  || |    ||   |        ||  | |      |\---++-+------+-----------+--+-+++-++-+--+---++-/ ||    | |      |   |||  |    |   | ||    || |
   |   | ||  |  |  || |    ||   |        ||  \-+------+----++-+------+-----------+--+-+++-++-+--+---+/   ||    \-+------+---++/  |    |   | ||    || |
   |   | ||  |  |  || |    ||   |        ||    |      |    |\-+------+-----------+--+-+++-++-+--+---+----++------+------+---+/   |    |   | ||    || |
   |   | ||  |  |  || |    ||   |        ||    |      |    |  |      |           |  \-+++-++-+--+---+----/|      |      |   |    |    |   | ||    || |
   |   | ||  |  |  || \----++---+--------++----/      |    |  |      |           |   /+++-++-+--+---+-----+------+------+---+\   |    |   | ||    || |
   |   | ||  |  |  \+------++---+--------+/     /-----+----+--+------+-----------+--\|\++-++-+--+---+-----+------+------+---++---+----+---+-++----+/ |
   |   | |\--+--+---+------/|   |        \------+-----+----+--+------+-----------+--++-++-++-+--+---+-----+------+------+---++---+----+---+-+/    |  |
   |   | |   |  \---+-------+---+--->-----------+-----+----+--+------+-----------+--++-++-++-+--+---+-----+------/      |   \+---+----+---+-+-----/  |
   |   | |   |      |       |   |               |     |    |  |      |           |  || || || |  |   |     |             |    |   |    |   | |        |
   |   | |   |      \-------+---+---------------+-----+----+--+------+-----------+--++-++-++-+--/   |     |             |    |   |    |   | |        |
   |   | |   \--------------+---+---------------+-----/    |  |      |           |  || || || \------+-----+-------------+----+---+----+---+-/        |
   |   | |                  |   |               |          \--+------+-----------+--++-/| ||        |     |             |    |   |    |   |          |
   |   | |                  |   |               |             |      |           |  ||  | \+--------+-----+-------------/    |   |    |   |          |
   |   | |                  |   |               |             |      |           |  ||  |  |        |     |                  |   |    |   |          |
   \---+-+------------------+---+---------------+-------------+------+-----------+--++--+--+--------+-----/                  |   |    |   |          |
       | \------------------+---+---------------+-------------+------+-----------+--++--+--/        |                        |   |    |   |          |
       |                    |   |               \-------------+------+-----------+--/|  \-----------+------------------------+---+----/   |          |
       |                    |   |                             |      \-----------+---+--------------+------------------------+---/        |          |
       |                    \---+-----------------------------+------------------/   \--------------+------------------------/            |          |
       \------------------------/                             |                                     |                                     |          |
                                                              |                                     \-------------------------------------/          |
                                                              \--------------------------------------------------------------------------------------/";
    }
}